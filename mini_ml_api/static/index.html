<!DOCTYPE html>
<form id="etaForm">
  <h2>Trip ETA Predictor</h2>
  <fieldset style="padding: 20px; max-width: 400px;">
    <legend><strong>Enter Trip Details</strong></legend>
    <label for="distance">Distance (km):</label><br />
    <input type="number" step="0.1" id="distance" name="distance" /><br /><br />

    <label for="speed">Speed (km/h):</label><br />
    <input type="number" step="0.1" id="speed" name="speed" /><br /><br />

    <label for="traffic_level">Traffic Level (0–1):</label><br />
    <input type="number" step="0.01" id="traffic_level" name="traffic_level" /><br /><br />

    <label for="weather">Weather Code:</label><br />
    <input type="number" id="weather" name="weather" /><br /><br />

    <label for="road_type">Road Type Code:</label><br />
    <input type="number" id="road_type" name="road_type" /><br /><br />

    <label for="day_of_week">Day Code (0=weekday, 1=weekend):</label><br />
    <input type="number" id="day_of_week" name="day_of_week" /><br /><br />

    <button type="submit">Predict ETA</button>
  </fieldset>
</form>

<div id="result"></div>

<script>
    document.getElementById("etaForm").addEventListener("submit", async function (e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const payload = Object.fromEntries(formData);
        for (let key in payload) payload[key] = parseFloat(payload[key]);

        const response = await fetch("/predict", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
        });
        const resultDiv = document.getElementById("result");

        if (!response.ok) {
            const error = await response.json();
            resultDiv.innerText = `Error: ${error.detail?.[0]?.loc?.join('.')} → ${error.detail?.[0]?.msg}`;
        } else {
            const data = await response.json();
            resultDiv.innerText = `Predicted ETA: ${data.predicted_time.toFixed(2)} hours`;
        }
    });
</script>
<h3>Input Code Reference</h3>
<table border="1" cellpadding="6" cellspacing="0">
  <thead>
    <tr>
      <th>Feature</th>
      <th>Code</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Weather</td>
      <td>0</td>
      <td>Clear</td>
    </tr>
    <tr>
      <td>Weather</td>
      <td>1</td>
      <td>Rainy</td>
    </tr>
    <tr>
      <td>Weather</td>
      <td>2</td>
      <td>Foggy</td>
    </tr>
    <tr>
      <td>Weather</td>
      <td>3</td>
      <td>Snowy</td>
    </tr>
    <tr>
      <td>Road Type</td>
      <td>0</td>
      <td>Highway</td>
    </tr>
    <tr>
      <td>Road Type</td>
      <td>1</td>
      <td>Urban</td>
    </tr>
    <tr>
      <td>Road Type</td>
      <td>2</td>
      <td>Residential</td>
    </tr>
    <tr>
      <td>Road Type</td>
      <td>3</td>
      <td>Rural</td>
    </tr>
    <tr>
      <td>Day</td>
      <td>0</td>
      <td>Weekday</td>
    </tr>
    <tr>
      <td>Day</td>
      <td>1</td>
      <td>Weekend</td>
    </tr>
  </tbody>
</table>